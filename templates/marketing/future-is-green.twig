{% extends 'layout.twig' %}

{% import 'marketing/partials/menu.twig' as menu %}
{% import 'marketing/partials/footer-menu.twig' as footerMenu %}
{% set cmsMainNavigation = cmsMainNavigation|default([]) %}
{% set menuItems = cmsMainNavigation is not empty ? cmsMainNavigation : cmsMenuItems|default([]) %}
{% set footerColumns = cmsFooterColumns|default([]) %}
{% set legalNavigation = cmsLegalNavigation|default([]) %}

{% block title %}{{ metaTitle|default('Future is Green – Urbane Logistik für lebenswerte Städte') }}{% endblock %}

{% block head %}
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <link rel="preload" href="{{ basePath }}/css/marketing.css" as="style">
  <link rel="stylesheet" href="{{ basePath }}/css/marketing.css">
  <link rel="stylesheet" href="{{ basePath }}/css/highcontrast.css">
  <link rel="stylesheet" href="{{ basePath }}/css/onboarding.css">
  <link rel="stylesheet" href="{{ basePath }}/css/topbar.marketing.css">
  <link rel="stylesheet" href="{{ basePath }}/css/future-is-green.css">
  <meta name="page-name" content="Future is Green – Landingpage">
  <script type="module" src="{{ basePath }}/js/marketing-design.js"></script>
{% endblock %}

{% block body_class %}marketing-page future-is-green-theme{% endblock %}

{% block body %}
  {% include 'marketing/partials/design-data.twig' %}
  <div class="marketing-layout">
    <header class="qr-topbar uk-position-sticky uk-top" id="start" uk-sticky="animation: uk-animation-slide-top; sel-target: .uk-navbar-container; cls-active: uk-navbar-sticky;">
      <nav class="uk-navbar-container" uk-navbar>
        <div class="uk-navbar-left">
          <div class="uk-navbar-item">
            <button id="offcanvas-toggle"
                    class="uk-navbar-toggle uk-hidden@m git-btn"
                    data-uk-navbar-toggle-icon
                    data-uk-toggle="target: #qr-offcanvas"
                    aria-controls="qr-offcanvas"
                    aria-expanded="false"
                    aria-label="Menü"></button>
            <a class="uk-logo fig-logo" href="{{ basePath }}/future-is-green">
              <span class="fig-visually-hidden">Future is Green – Logistic Solutions</span>
              <span class="fig-logo__image" aria-hidden="true">
                <img class="fig-logo__img"
                     src="{{ basePath }}/uploads/future-is-green-logo.webp"
                     alt=""
                     loading="eager"
                     decoding="async">
              </span>
              <span class="fig-logo__wordmark" aria-hidden="true">
                <svg class="fig-logo__wordmark-svg" viewBox="0 0 320 92" xmlns="http://www.w3.org/2000/svg" focusable="false">
                  <text x="0"
                        y="38"
                        font-family="Poppins, 'Helvetica Neue', Arial, sans-serif"
                        font-size="34"
                        font-weight="700"
                        letter-spacing="0.02em">
                    <tspan class="fig-wordmark__strong" fill="currentColor">FUTURE</tspan>
                    <tspan class="fig-wordmark__connector" fill="currentColor" font-weight="500"> is </tspan>
                    <tspan class="fig-wordmark__strong" fill="currentColor">GREEN</tspan>
                  </text>
                  <text x="0"
                        y="78"
                        class="fig-wordmark__subtitle"
                        font-family="Poppins, 'Helvetica Neue', Arial, sans-serif"
                        font-size="18"
                        letter-spacing="0.32em"
                        font-weight="500"
                        fill="currentColor">LOGISTIC SOLUTIONS</text>
                </svg>
              </span>
            </a>
          </div>
        </div>
        <div class="uk-navbar-center uk-visible@m">
          {{ menu.render_menu(menuItems, 'uk-navbar-nav fig-mega-nav', 'uk-dropdown="offset: 20; delay-hide: 150; pos: bottom-left"') }}
        </div>
        <div class="uk-navbar-right">
          <div class="uk-navbar-item fig-cta uk-visible@m">
            <a class="fig-primary-link" href="#kontakt" uk-scroll>
              <span class="uk-margin-small-right" data-uk-icon="icon: play"></span>Demo anfragen
            </a>
          </div>
          {% include 'components/config-menu.twig' with {
            show_help: false,
            show_language: headerConfig.show_language|default(true),
            show_theme_toggle: headerConfig.show_theme_toggle|default(true),
            show_contrast_toggle: headerConfig.show_contrast_toggle|default(true)
          } %}

        </div>
      </nav>
    </header>

    <div id="qr-offcanvas" data-uk-offcanvas="overlay: true; flip: true">
      <div class="uk-offcanvas-bar">
        <button class="uk-offcanvas-close git-btn" type="button" data-uk-close aria-label="Menü schließen"></button>
        {{ menu.render_offcanvas(menuItems, 'uk-nav uk-nav-default fig-offcanvas-nav') }}
        <a class="uk-button uk-button-primary git-btn uk-width-1-1 uk-margin-top offcanvas-cta" href="#kontakt" uk-scroll>
          <span class="uk-margin-small-right" data-uk-icon="icon: play"></span>Demo anfragen
        </a>
      </div>
    </div>

    <section class="fig-hero uk-section uk-section-large">
      <div class="uk-container">
        <div class="uk-grid uk-grid-large uk-child-width-1-2@m uk-flex-middle" data-uk-grid>
          <div class="fig-hero__copy" data-uk-scrollspy="cls: uk-animation-slide-left-small">
            <span class="fig-hero__badge">Gemeinsam gestalten wir die letzte Meile</span>
            <h1 class="fig-hero__title">Future is Green – die urbane Logistik von morgen: leise, lokal und nachhaltig.</h1>
            <p class="fig-hero__subtitle">Die Stadt atmet auf: saubere Luft, weniger Lärm, effizientere Wege. Wir verbinden lokale Händler:innen, smarte Hubs und leise E-Cargobikes zu einer Logistikkette, die für Menschen, Umwelt und Wirtschaft funktioniert.</p>
            <div class="fig-hero__actions">
              <a class="fig-button fig-button--primary" href="#contact">
                <span class="uk-margin-small-right" data-uk-icon="icon: cart"></span>Händler:in werden
              </a>
              <a class="fig-button fig-button--ghost" href="#contact">
                <span class="uk-margin-small-right" data-uk-icon="icon: calendar"></span>Pilot anfragen
              </a>
            </div>
          </div>
          <div class="fig-hero__visual" data-uk-scrollspy="cls: uk-animation-slide-right-small; delay: 150">
            <div class="fig-hero__card uk-card uk-card-default uk-card-body">
              <h2 class="fig-hero__card-title">Wir machen City-Logistik messbar nachhaltig.</h2>
              <p>Von der Anlieferung im Mikrohub bis zur letzten Meile per Cargo-Bike: Future is Green reduziert Verkehr, Emissionen und Lieferzeiten in dicht besiedelten Quartieren.</p>
              <div class="fig-hero__card-metric">
                <span class="fig-hero__metric-value">7,4&nbsp;t</span>
                <span class="fig-hero__metric-label">CO₂-Ersparnis pro Jahr in Pilotgebieten</span>
              </div>
              <p class="fig-hero__card-note">Live-Dashboards machen Fortschritt sichtbar – für Kommunen, Händler:innen und Bürger:innen.</p>
            </div>
          </div>
        </div>
        <div class="fig-hero__stats-bar" data-uk-scrollspy="cls: uk-animation-fade; delay: 200">
          <ul class="fig-hero__stats" role="list">
            <li class="fig-hero__stat" role="listitem">
              <span class="fig-hero__stat-icon" aria-hidden="true">
                <svg viewBox="0 0 24 24" focusable="false">
                  <path d="M5 20V7.5L12 4l7 3.5V20"></path>
                  <path d="M9 20v-6h6v6"></path>
                </svg>
              </span>
              <span class="fig-hero__stat-label">
                <strong>3</strong>
                <span>Mikrohub-Piloten im Betrieb</span>
              </span>
            </li>
            <li class="fig-hero__stat" role="listitem">
              <span class="fig-hero__stat-icon" aria-hidden="true">
                <svg viewBox="0 0 24 24" focusable="false">
                  <path d="M4 12a8 8 0 1 1 16 0 8 8 0 0 1-16 0Z"></path>
                  <path d="M12 7v6l3 2"></path>
                </svg>
              </span>
              <span class="fig-hero__stat-label">
                <strong>92%</strong>
                <span>Same-Day-Lieferungen pünktlich</span>
              </span>
            </li>
            <li class="fig-hero__stat" role="listitem">
              <span class="fig-hero__stat-icon" aria-hidden="true">
                <svg viewBox="0 0 24 24" focusable="false">
                  <path d="M5 16.5 14.5 7"></path>
                  <path d="M9 7h5V12"></path>
                  <path d="M4 20h10"></path>
                </svg>
              </span>
              <span class="fig-hero__stat-label">
                <strong>15 km</strong>
                <span>durch&shy;schnittliche Tour pro Rider</span>
              </span>
            </li>
            <li class="fig-hero__stat" role="listitem">
              <span class="fig-hero__stat-icon" aria-hidden="true">
                <svg viewBox="0 0 24 24" focusable="false">
                  <path d="M4 18V6h16v12"></path>
                  <path d="M4 10h16"></path>
                  <path d="M7 14h3"></path>
                  <path d="M14 14h3"></path>
                </svg>
              </span>
              <span class="fig-hero__stat-label">
                <strong>45</strong>
                <span>lokale Händler:innen an Bord</span>
              </span>
            </li>
            <li class="fig-hero__stat" role="listitem">
              <span class="fig-hero__stat-icon" aria-hidden="true">
                <svg viewBox="0 0 24 24" focusable="false">
                  <path d="M12 6v12"></path>
                  <path d="M6 10h12"></path>
                  <circle cx="12" cy="12" r="8"></circle>
                </svg>
              </span>
              <span class="fig-hero__stat-label">
                <strong>Echtzeit</strong>
                <span>Impact-Dashboards für Kommunen</span>
              </span>
            </li>
          </ul>
        </div>
        {% set trustLogos = [
          'Stadtwerke',
          'IHK',
          'Hochschule&nbsp;XY',
          'EU-Regionalfonds',
          'Urbane Innovation&nbsp;2025',
          'Logistiknetzwerk&nbsp;Nord',
          'Bundesumweltamt',
          'Förderinitiative&nbsp;Smart&nbsp;City',
          'Mobilitätsrat&nbsp;Zukunft'
        ] %}
        <div class="fig-trust" data-uk-scrollspy="cls: uk-animation-fade; delay: 200">
          <div class="fig-trust__headline">
            <span>Gefördert &amp; unterstützt von</span>
            <div class="fig-trust__ticker" aria-hidden="true">
              <div class="fig-trust__ticker-track">
                {% for logo in trustLogos %}
                  <span class="fig-trust__pill">{{ logo|raw }}</span>
                {% endfor %}
                {% for logo in trustLogos %}
                  <span class="fig-trust__pill">{{ logo|raw }}</span>
                {% endfor %}
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>

    {% include 'marketing/partials/block-content.twig' %}

    {% include 'marketing/partials/page-modules.twig' with {
      modules: pageModules['after-content']|default([]),
      position: 'after-content'
    } %}
  </div>
{% endblock %}

{% block footer %}
  <div class="fig-footer">
    <div class="footer-columns">
      <div class="footer-section footer-about">
        <strong>Future is Green</strong>
        <p>Urbane Logistik für lebenswerte Städte – leise, lokal und nachhaltig.</p>
      </div>
      <div class="footer-section footer-contact">
        <strong>Kontakt</strong>
        <p>
          Future is Green Logistic Solutions<br>
          <a
            class="js-email-link"
            data-user="hello"
            data-domain="futureisgreen.city"
            href="#"
          >hello [at] futureisgreen.city</a>
        </p>
        <ul>
          <li>
            <a href="https://www.linkedin.com" rel="noopener" target="_blank">
              <span class="uk-margin-small-right" data-uk-icon="icon: linkedin"></span>LinkedIn
            </a>
          </li>
          <li>
            <a href="https://mastodon.social" rel="noopener" target="_blank">
              <span class="uk-margin-small-right" data-uk-icon="icon: world"></span>Mastodon
            </a>
          </li>
        </ul>
      </div>
      {% if footerColumns %}
        <div class="footer-section footer-navigation">
          <strong>Bereiche</strong>
          {{ footerMenu.render_columns(
            footerColumns,
            'footer-navigation-grid uk-grid-small uk-child-width-1-1 uk-child-width-1-3@m',
            'footer-navigation-column',
            'uk-grid'
          ) }}
        </div>
      {% endif %}
      <div class="footer-section footer-legal">
        <strong>Rechtliches</strong>
        {{ footerMenu.render_links(legalNavigation) }}
      </div>
    </div>
  </div>
{% endblock %}

{% block scripts %}
  <script src="{{ basePath }}/js/storage.js"></script>
  <script src="{{ basePath }}/js/landing.js" defer></script>
  {% if turnstileSiteKey %}
    <script src="https://challenges.cloudflare.com/turnstile/v0/api.js" defer></script>
  {% endif %}
  <script>
    (function () {
      var hoverIntentTimer;

      function scheduleSwap(e) {
        var link = e.target.closest('a[data-explain]');
        if (!link) {
          return;
        }

        clearTimeout(hoverIntentTimer);

        if (e.type === 'focusin') {
          swapPane(link);
          return;
        }

        hoverIntentTimer = setTimeout(function () {
          swapPane(link);
        }, 90);
      }

      function swapPane(link) {
        var dropdown = link.closest('.uk-navbar-dropdown');
        if (!dropdown) {
          return;
        }

        var explainKey = link.getAttribute('data-explain');
        var panes = dropdown.querySelectorAll('.menu-explain .explain-pane');
        panes.forEach(function (pane) {
          var key = pane.getAttribute('data-explain-pane');
          pane.classList.toggle('uk-hidden', key !== explainKey);
        });
      }

      document.addEventListener('mouseover', scheduleSwap, true);
      document.addEventListener('focusin', scheduleSwap, true);
    })();

    function enhanceTechnologySection() {
      var grid = document.querySelector('#technology .fig-technology-grid');
      if (!grid || grid.classList.contains('fig-technology-grid--is-enhanced')) {
        return;
      }

      if (grid.dataset.figTechnologyEnhanced === 'true') {
        return;
      }

      var cards = Array.prototype.slice.call(grid.querySelectorAll('.fig-technology-card'));
      if (cards.length === 0) {
        return;
      }

      function stripAnimationClasses(node) {
        if (!node || !node.classList) {
          return;
        }

        if (node.classList.contains('uk-invisible')) {
          node.classList.remove('uk-invisible');
        }

        Array.prototype.slice.call(node.classList).forEach(function (className) {
          if (className.indexOf('uk-animation-') === 0) {
            node.classList.remove(className);
          }
        });

        Array.prototype.forEach.call(node.children || [], stripAnimationClasses);
      }

      var interactive = document.createElement('div');
      interactive.className = 'fig-technology-interactive';

      var scrollspyConfig = grid.getAttribute('data-uk-scrollspy');
      if (scrollspyConfig) {
        interactive.setAttribute('data-uk-scrollspy', scrollspyConfig);
      }

      var navWrapper = document.createElement('div');
      navWrapper.className = 'fig-technology-interactive__nav';

      var navList = document.createElement('ul');
      navList.className = 'fig-technology-nav';
      navList.setAttribute('role', 'tablist');
      navList.setAttribute('aria-orientation', 'vertical');
      navWrapper.appendChild(navList);

      var display = document.createElement('div');
      display.className = 'fig-technology-interactive__display';

      interactive.appendChild(navWrapper);
      interactive.appendChild(display);

      var buttons = [];
      var panels = [];
      var activeIndex = 0;
      var observedPanel = null;
      var raf = window.requestAnimationFrame || function (callback) {
        return window.setTimeout(callback, 16);
      };
      var measurementScheduled = false;
      var desktopMediaQuery = window.matchMedia
        ? window.matchMedia('(min-width: 960px)')
        : null;

      function shouldLockDisplayHeight() {
        if (!desktopMediaQuery) {
          return true;
        }

        return desktopMediaQuery.matches;
      }
      var resizeObserver = typeof ResizeObserver === 'function'
        ? new ResizeObserver(function () {
            scheduleDisplayHeightMeasurement();
          })
        : null;

      function measurePanelHeight(panel) {
        if (!panel) {
          return 0;
        }

        var isCurrentlyVisible = !panel.hasAttribute('hidden') && panel.classList.contains('is-active');
        if (isCurrentlyVisible) {
          return panel.offsetHeight;
        }

        var wasHidden = panel.hasAttribute('hidden');
        var hadActiveClass = panel.classList.contains('is-active');

        if (wasHidden) {
          panel.removeAttribute('hidden');
        }

        if (!hadActiveClass) {
          panel.classList.add('is-active');
        }

        var previousTransition = panel.style.transition;
        var previousPosition = panel.style.position;
        var previousVisibility = panel.style.visibility;
        var previousPointerEvents = panel.style.pointerEvents;
        var previousHeight = panel.style.height;
        var previousWidth = panel.style.width;

        panel.style.transition = 'none';
        panel.style.position = 'absolute';
        panel.style.visibility = 'hidden';
        panel.style.pointerEvents = 'none';
        panel.style.height = 'auto';
        if (display.clientWidth) {
          panel.style.width = display.clientWidth + 'px';
        }

        var measuredHeight = panel.offsetHeight;

        panel.style.transition = previousTransition;
        panel.style.position = previousPosition;
        panel.style.visibility = previousVisibility;
        panel.style.pointerEvents = previousPointerEvents;
        panel.style.height = previousHeight;
        panel.style.width = previousWidth;

        if (!hadActiveClass) {
          panel.classList.remove('is-active');
        }

        if (wasHidden) {
          panel.setAttribute('hidden', 'true');
        }

        return measuredHeight;
      }

      function scheduleDisplayHeightMeasurement() {
        if (measurementScheduled) {
          return;
        }

        measurementScheduled = true;

        raf(function () {
          measurementScheduled = false;

          if (!shouldLockDisplayHeight()) {
            display.style.minHeight = '';
            return;
          }

          var activePanel = panels[activeIndex];
          var measuredHeight = measurePanelHeight(activePanel);

          if (measuredHeight > 0) {
            display.style.minHeight = measuredHeight + 'px';
          } else {
            display.style.minHeight = '';
          }
        });
      }

      cards.forEach(function (card, index) {
        var panel = card.cloneNode(true);
        stripAnimationClasses(panel);
        var panelId = 'fig-technology-panel-' + index;
        var tabId = 'fig-technology-tab-' + index;

        panel.id = panelId;
        panel.classList.add('fig-technology-panel');
        panel.setAttribute('role', 'tabpanel');
        panel.setAttribute('aria-labelledby', tabId);
        if (index !== 0) {
          panel.setAttribute('hidden', 'true');
        } else {
          panel.classList.add('is-active');
        }

        display.appendChild(panel);
        panels.push(panel);

        var heading = panel.querySelector('h3');
        var headingText = heading ? heading.textContent.trim() : 'Technologie ' + (index + 1);

        var summaryText = '';
        var summarySource = card.querySelector('.fig-feature-list li span:last-child');
        if (summarySource) {
          summaryText = summarySource.textContent.trim();
        }

        var item = document.createElement('li');
        item.className = 'fig-technology-nav__item';
        item.setAttribute('role', 'presentation');

        var button = document.createElement('button');
        button.type = 'button';
        button.className = 'fig-technology-nav__button';
        button.id = tabId;
        button.setAttribute('role', 'tab');
        button.setAttribute('aria-controls', panelId);
        button.setAttribute('aria-selected', index === 0 ? 'true' : 'false');
        button.setAttribute('tabindex', index === 0 ? '0' : '-1');

        var titleSpan = document.createElement('span');
        titleSpan.className = 'fig-technology-nav__title';
        titleSpan.textContent = headingText;
        button.appendChild(titleSpan);

        if (summaryText !== '') {
          var descSpan = document.createElement('span');
          descSpan.className = 'fig-technology-nav__desc';
          descSpan.textContent = summaryText;
          button.appendChild(descSpan);
        }

        if (index === 0) {
          button.classList.add('is-active');
        }

        item.appendChild(button);
        navList.appendChild(item);
        buttons.push(button);

        button.addEventListener('click', function () {
          activate(index, false);
        });

        button.addEventListener('keydown', function (event) {
          var key = event.key || event.which;
          var targetIndex = null;

          if (key === 'ArrowDown' || key === 'ArrowRight' || key === 40 || key === 39) {
            targetIndex = (index + 1) % buttons.length;
          } else if (key === 'ArrowUp' || key === 'ArrowLeft' || key === 38 || key === 37) {
            targetIndex = (index - 1 + buttons.length) % buttons.length;
          } else if (key === 'Home' || key === 36) {
            targetIndex = 0;
          } else if (key === 'End' || key === 35) {
            targetIndex = buttons.length - 1;
          }

          if (targetIndex !== null) {
            event.preventDefault();
            activate(targetIndex, true);
          }
        });
      });

      function activate(newIndex, focusTab) {
        if (newIndex < 0 || newIndex >= panels.length) {
          return;
        }

        activeIndex = newIndex;

        buttons.forEach(function (btn, idx) {
          var isActive = idx === newIndex;
          btn.classList.toggle('is-active', isActive);
          btn.setAttribute('aria-selected', isActive ? 'true' : 'false');
          btn.setAttribute('tabindex', isActive ? '0' : '-1');
          if (isActive && focusTab) {
            btn.focus();
          }
        });

        panels.forEach(function (panel, idx) {
          var shouldShow = idx === newIndex;
          if (shouldShow) {
            panel.removeAttribute('hidden');
            panel.classList.add('is-active');
          } else {
            panel.setAttribute('hidden', 'true');
            panel.classList.remove('is-active');
          }
        });

        if (resizeObserver) {
          if (observedPanel) {
            resizeObserver.unobserve(observedPanel);
          }

          observedPanel = panels[newIndex];

          if (observedPanel) {
            resizeObserver.observe(observedPanel);
          }
        }

        scheduleDisplayHeightMeasurement();
        window.setTimeout(scheduleDisplayHeightMeasurement, 120);
      }

      activate(activeIndex, false);

      grid.insertAdjacentElement('afterend', interactive);
      grid.classList.add('fig-technology-grid--is-enhanced');
      grid.setAttribute('aria-hidden', 'true');
      grid.dataset.figTechnologyEnhanced = 'true';

      if (desktopMediaQuery) {
        var mqListener = scheduleDisplayHeightMeasurement;
        if (typeof desktopMediaQuery.addEventListener === 'function') {
          desktopMediaQuery.addEventListener('change', mqListener);
        } else if (typeof desktopMediaQuery.addListener === 'function') {
          desktopMediaQuery.addListener(mqListener);
        }
      }

      window.addEventListener('resize', scheduleDisplayHeightMeasurement);
    }

    document.addEventListener('DOMContentLoaded', function () {
      var contactForm = document.getElementById('contact-form');
      if (contactForm && !contactForm.hasAttribute('data-contact-endpoint')) {
        contactForm.setAttribute('data-contact-endpoint', '{{ basePath }}/future-is-green/contact');
      }

      var contactSection = document.getElementById('contact');
      if (contactSection && !document.getElementById('kontakt')) {
        var anchor = document.createElement('div');
        anchor.id = 'kontakt';
        anchor.className = 'fig-scroll-anchor';
        anchor.setAttribute('aria-hidden', 'true');
        contactSection.insertAdjacentElement('afterbegin', anchor);
      }

      var topbar = document.querySelector('.future-is-green-theme .qr-topbar');
      if (topbar) {
        var toggleTopbarState = function () {
          if (window.scrollY > 12) {
            topbar.classList.add('fig-topbar--condensed');
          } else {
            topbar.classList.remove('fig-topbar--condensed');
          }
        };

        toggleTopbarState();
        window.addEventListener('scroll', toggleTopbarState, { passive: true });
      }

      enhanceTechnologySection();
    });
  </script>
{% endblock %}
