{% extends 'layout.twig' %}

{% set links = [
    { 'href': '#trust', 'label': t('calserver_mega_overview_trust'), 'icon': 'star' },
    { 'href': '#features', 'label': t('calserver_nav_features'), 'icon': 'grid' },
    { 'href': '#modules', 'label': t('calserver_nav_modules'), 'icon': 'database' },
    { 'href': '#usecases', 'label': t('calserver_nav_usecases'), 'icon': 'users' },
    { 'href': '#metcal', 'label': t('calserver_nav_metcal'), 'icon': 'link' },
    { 'href': '#modes', 'label': t('calserver_nav_modes'), 'icon': 'cog' },
    { 'href': '#calserver-news', 'label': t('calserver_nav_news'), 'icon': 'rss' },
    { 'href': '#pricing', 'label': t('calserver_nav_pricing'), 'icon': 'credit-card' },
    { 'href': '#faq', 'label': t('calserver_nav_faq'), 'icon': 'question' },
    { 'href': '#demo', 'label': t('calserver_mega_resources_contact'), 'icon': 'play' }
] %}
{% set megaNav = [
  {
    'label': t('calserver_mega_overview'),
    'items': [
      { 'href': '#trust', 'label': t('calserver_mega_overview_trust'), 'explain': 'overview_trust' },
      { 'href': '#demo', 'label': t('calserver_mega_overview_demo'), 'explain': 'overview_demo' }
    ],
    'explain': [
      {
        'key': 'overview_trust',
        'title': t('calserver_mega_overview_trust_title'),
        'description': t('calserver_mega_overview_trust_desc'),
        'subline': t('calserver_mega_overview_trust_subline')
      },
      {
        'key': 'overview_demo',
        'title': t('calserver_mega_overview_demo_title'),
        'description': t('calserver_mega_overview_demo_desc'),
        'subline': t('calserver_mega_overview_demo_subline')
      }
    ]
  },
  {
    'label': t('calserver_mega_features'),
    'items': [
      { 'href': '#features', 'label': t('calserver_mega_features_features'), 'explain': 'features_overview' },
      { 'href': '#modules', 'label': t('calserver_mega_features_modules'), 'explain': 'features_modules' }
    ],
    'explain': [
      {
        'key': 'features_overview',
        'title': t('calserver_mega_features_features_title'),
        'description': t('calserver_mega_features_features_desc'),
        'subline': t('calserver_mega_features_features_subline')
      },
      {
        'key': 'features_modules',
        'title': t('calserver_mega_features_modules_title'),
        'description': t('calserver_mega_features_modules_desc'),
        'subline': t('calserver_mega_features_modules_subline')
      }
    ]
  },
  {
    'label': t('calserver_mega_solutions'),
    'items': [
      { 'href': '#usecases', 'label': t('calserver_mega_solutions_usecases'), 'explain': 'solutions_usecases' },
      { 'href': '#metcal', 'label': t('calserver_mega_solutions_metcal'), 'explain': 'solutions_metcal' }
    ],
    'explain': [
      {
        'key': 'solutions_usecases',
        'title': t('calserver_mega_solutions_usecases_title'),
        'description': t('calserver_mega_solutions_usecases_desc'),
        'subline': t('calserver_mega_solutions_usecases_subline')
      },
      {
        'key': 'solutions_metcal',
        'title': t('calserver_mega_solutions_metcal_title'),
        'description': t('calserver_mega_solutions_metcal_desc'),
        'subline': t('calserver_mega_solutions_metcal_subline')
      }
    ]
  },
  {
    'label': t('calserver_mega_operations'),
    'items': [
      { 'href': '#modes', 'label': t('calserver_mega_operations_modes'), 'explain': 'operations_modes' },
      { 'href': '#pricing', 'label': t('calserver_mega_operations_pricing'), 'explain': 'operations_pricing' }
    ],
    'explain': [
      {
        'key': 'operations_modes',
        'title': t('calserver_mega_operations_modes_title'),
        'description': t('calserver_mega_operations_modes_desc'),
        'subline': t('calserver_mega_operations_modes_subline')
      },
      {
        'key': 'operations_pricing',
        'title': t('calserver_mega_operations_pricing_title'),
        'description': t('calserver_mega_operations_pricing_desc'),
        'subline': t('calserver_mega_operations_pricing_subline')
      }
    ]
  },
  {
    'label': t('calserver_mega_resources'),
    'items': [
      { 'href': '#calserver-news', 'label': t('calserver_mega_resources_news'), 'explain': 'resources_news' },
      { 'href': '#faq', 'label': t('calserver_mega_resources_faq'), 'explain': 'resources_faq' },
      { 'href': '#demo', 'label': t('calserver_mega_resources_contact'), 'explain': 'resources_contact' }
    ],
    'explain': [
      {
        'key': 'resources_news',
        'title': t('calserver_mega_resources_news_title'),
        'description': t('calserver_mega_resources_news_desc'),
        'subline': t('calserver_mega_resources_news_subline')
      },
      {
        'key': 'resources_faq',
        'title': t('calserver_mega_resources_faq_title'),
        'description': t('calserver_mega_resources_faq_desc'),
        'subline': t('calserver_mega_resources_faq_subline')
      },
      {
        'key': 'resources_contact',
        'title': t('calserver_mega_resources_contact_title'),
        'description': t('calserver_mega_resources_contact_desc'),
        'subline': t('calserver_mega_resources_contact_subline')
      }
    ]
  }
] %}
{% if marketingWikiMenu is defined %}
  {% set links = links|merge([{ 'href': marketingWikiMenu.url, 'label': marketingWikiMenu.label, 'icon': 'file-text' }]) %}
{% endif %}

{% block title %}{{ metaTitle|default('calServer – Kalibrier- und Inventarverwaltung für Teams') }}{% endblock %}

{% block head %}
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@100;200;300;400;500;600;700;800;900&display=swap"
        rel="stylesheet">
  <link rel="preload" href="{{ basePath }}/css/landing.css" as="style">
  <link rel="stylesheet" href="{{ basePath }}/css/landing.css">
  <link rel="stylesheet" href="{{ basePath }}/css/calserver.css">
  <link rel="stylesheet" href="{{ basePath }}/css/highcontrast.css">
  <link rel="stylesheet" href="{{ basePath }}/css/onboarding.css">
  <link rel="stylesheet" href="{{ basePath }}/css/topbar.landing.css">
  <meta name="page-name" content="calServer – Marketingseite">
{% endblock %}

{% block body_theme %}light{% endblock %}
{% block body_class %}qr-landing calserver-theme{% endblock %}

{% block body %}
  <div class="landing-content">
    <header class="qr-topbar uk-position-sticky uk-top" id="start"
            data-uk-sticky="animation: uk-animation-slide-top; sel-target: .uk-navbar-container; cls-active: uk-navbar-sticky;">
      <nav class="uk-navbar-container" data-uk-navbar>
        <div class="uk-navbar-left">
          <div class="uk-navbar-item">
            <button id="offcanvas-toggle"
                    class="uk-navbar-toggle uk-hidden@m git-btn"
                    data-uk-navbar-toggle-icon
                    data-uk-toggle="target: #qr-offcanvas"
                    aria-controls="qr-offcanvas"
                    aria-expanded="false"
                    aria-label="Menü"></button>
            <a class="uk-logo cs-logo" href="{{ basePath }}/calserver">
              <span class="cs-logo__sr">calServer – Digitale Plattform für Kalibrier- und Inventarverwaltung</span>
              <span class="cs-logo__image" aria-hidden="true">
                <img class="cs-logo__img"
                     src="{{ basePath }}/uploads/calserver-logo.webp"
                     alt=""
                     loading="eager"
                     decoding="async">
              </span>
              <span class="cs-logo__wordmark" aria-hidden="true">calServer</span>
            </a>
          </div>
        </div>
        <div class="uk-navbar-center uk-visible@m">
          <ul class="uk-navbar-nav cs-mega-nav">
            {% for group in megaNav %}
              {% set primaryItem = group.items|first %}
              <li>
                <a href="{{ primaryItem.href }}"{% if primaryItem.href starts with '#' %} data-uk-scroll{% endif %}>{{ group.label }}</a>
                <div class="uk-navbar-dropdown uk-padding-remove"
                     data-uk-dropdown="offset: 20; delay-hide: 150; pos: bottom-left">
                  <div class="uk-grid-divider uk-grid-small uk-child-width-1-2@s" data-uk-grid>
                    <div>
                      <ul class="uk-nav uk-navbar-dropdown-nav">
                        {% for item in group.items %}
                          <li>
                            <a href="{{ item.href }}"{% if item.href starts with '#' %} data-uk-scroll{% endif %}{% if item.explain is defined %} data-explain="{{ item.explain }}"{% endif %}>
                              {{ item.label }}
                            </a>
                          </li>
                        {% endfor %}
                      </ul>
                    </div>
                    {% if group.explain is defined and group.explain|length %}
                      <div class="menu-explain">
                        {% for pane in group.explain %}
                          <div class="explain-pane{% if not loop.first %} uk-hidden{% endif %}" data-explain-pane="{{ pane.key }}">
                            <h5>{{ pane.title }}</h5>
                            <p>{{ pane.description }}</p>
                            {% if pane.subline is defined and pane.subline %}
                              <p class="menu-explain__subline">{{ pane.subline }}</p>
                            {% endif %}
                          </div>
                        {% endfor %}
                      </div>
                    {% endif %}
                  </div>
                </div>
              </li>
            {% endfor %}
            {% if marketingWikiMenu is defined %}
              <li>
                <a href="{{ marketingWikiMenu.url }}">{{ marketingWikiMenu.label }}</a>
              </li>
            {% endif %}
          </ul>
        </div>
        <div class="uk-navbar-right">
          {% include 'components/config-menu.twig' with { show_help: false } %}

        </div>
      </nav>
    </header>

    <div id="qr-offcanvas" data-uk-offcanvas="overlay: true; flip: true">
      <div class="uk-offcanvas-bar">
        <button class="uk-offcanvas-close git-btn" type="button" data-uk-close aria-label="Menü schließen"></button>
        <ul class="uk-nav uk-nav-default">
          {% for link in links %}
            <li>
              <a href="{{ link.href }}">
                <span class="uk-margin-small-right" data-uk-icon="icon: {{ link.icon }}"></span>{{ link.label }}
              </a>
            </li>
          {% endfor %}
        </ul>
        <a class="uk-button uk-button-default git-btn uk-width-1-1 uk-margin-top offcanvas-cta"
           href="https://calendly.com/calhelp/calserver-vorstellung"
           target="_blank"
           rel="noopener">
          <span class="uk-margin-small-right" data-uk-icon="icon: calendar"></span>{{ t('calserver_nav_demo') }}
        </a>
      </div>
    </div>

    {% set heroLocale = locale() == 'en' ? 'en' : 'de' %}
    {% set heroCopy = {
      'de': {
        'badge': 'Software gehostet in Deutschland',
        'title': 'Mehr Überblick, weniger Aufwand mit calServer.',
        'subtitle': 'Geräte, Termine und Dokumente – organisiert an einem Ort. calServer strukturiert die Kalibrier- und Inventarverwaltung für das ganze Team.',
        'bullets': [
          'Nie wieder Fristen verpassen.',
          'Transparente Workflows für Labor, Service und Verwaltung.',
          'In Deutschland betrieben, DSGVO-konform.'
        ],
        'ctaPrimary': 'Jetzt testen',
        'ctaSecondary': 'Demo buchen',
        'ctaChat': 'Assistent fragen',
        'proof': 'Unbegrenzte Nutzer:innen · Flexible Rollenmodelle · Tägliche Datensicherung',
        'videoBadge': 'Live-Vorschau',
        'videoAriaLabel': 'YouTube-Video',
        'videoPreviewTitle': 'Video-Vorschau',
        'videoPreviewSubtitle': 'calServer Vorstellung auf YouTube',
        'videoHint': 'Vorstellung hier laden. Mit deinem Klick werden YouTube-Inhalte nachgeladen und Google kann personenbezogene Daten verarbeiten.',
        'videoButton': 'Video laden',
        'videoPrivacy': 'Du kannst deine Einwilligung jederzeit in deinen Browser-Einstellungen und mit der Schaltfläche unten links widerrufen.',
        'videoNoscript': 'JavaScript ist deaktiviert. Öffne das Video direkt auf',
        'videoNoscriptLink': 'YouTube',
        'videoNoscriptSuffix': '.',
        'videoMetaTitle': 'calServer Vorstellung',
        'videoMetaSubtitle': 'In 3 Minuten durch die wichtigsten Funktionen.',
        'videoLinkLabel': 'Auf YouTube ansehen',
        'videoFootnoteStrong': 'Schnelle Suche · Klare Tabellen · Intuitive Workflows · Smarte Analysen · Echtzeit-Insights · Nahtlose Integrationen',
        'videoFootnoteSpan': 'Mehr Überblick, mehr Tempo, mehr Wow für dein Team.'
      },
      'en': {
        'badge': 'Software hosted in Germany',
        'title': 'More visibility, less effort with calServer.',
        'subtitle': 'Instruments, schedules and documents—organized in one place. calServer streamlines calibration and inventory management for your entire team.',
        'bullets': [
          'Deadlines come to you, not the other way around.',
          'Transparent workflows for lab, service and administration.',
          'Hosted in Germany, GDPR-compliant.'
        ],
        'ctaPrimary': 'Start trial',
        'ctaSecondary': 'Book demo',
        'ctaChat': 'Ask assistant',
        'proof': 'Unlimited users · Flexible role models · Daily backups',
        'videoBadge': 'Live preview',
        'videoAriaLabel': 'YouTube video',
        'videoPreviewTitle': 'Video preview',
        'videoPreviewSubtitle': 'calServer introduction on YouTube',
        'videoHint': 'Load the introduction right here. By clicking you allow YouTube content to be loaded. Google may process personal data in the process.',
        'videoButton': 'Load video',
        'videoPrivacy': 'You can withdraw your consent at any time in your browser settings.',
        'videoNoscript': 'JavaScript is disabled. Open the video directly on',
        'videoNoscriptLink': 'YouTube',
        'videoNoscriptSuffix': '.',
        'videoMetaTitle': 'calServer introduction',
        'videoMetaSubtitle': 'Three-minute overview of the key features.',
        'videoLinkLabel': 'Watch on YouTube',
        'videoFootnoteStrong': 'Fast search · Clear tables · Intuitive workflows · Smart analytics · Real-time insights · Seamless integrations',
        'videoFootnoteSpan': 'More visibility, more speed, more wow for your team.'
      }
    } %}
    {% set hero = heroCopy[heroLocale] %}

    <section class="qr-hero uk-section uk-section-large">
      <div class="qr-hero-bg hero-bg-calserver"
           aria-hidden="true"
           data-calserver-hero-bg>
        <canvas class="calserver-hero-bg__canvas" data-calserver-hero-canvas></canvas>
      </div>
      <div class="uk-container">
        <div class="uk-grid uk-grid-large uk-child-width-1-2@m uk-flex-middle calserver-hero-grid" data-uk-grid>
          <div class="calserver-hero-grid__content" data-uk-scrollspy="cls: uk-animation-slide-left-small; repeat: true">
            <span class="qr-badge pill pill--soft">{{ hero.badge }}</span>
            <h1 class="qr-h1">{{ hero.title }}</h1>
            <p class="qr-sub">{{ hero.subtitle }}</p>
            <ul class="uk-list uk-list-bullet hero-list">
              {% for bullet in hero.bullets %}
                <li>{{ bullet }}</li>
              {% endfor %}
            </ul>
            <div class="uk-margin-medium-top uk-flex uk-flex-left uk-flex-wrap" style="gap:16px;">
              <a class="uk-button uk-button-primary cta-main" href="#trial">
                <span class="uk-margin-small-right" data-uk-icon="icon: play"></span>{{ hero.ctaPrimary }}
              </a>
              <a class="btn btn-transparent" href="https://calendly.com/calhelp/calserver-vorstellung"
                 target="_blank"
                 rel="noopener">
                <span class="uk-margin-small-right" data-uk-icon="icon: calendar"></span>{{ hero.ctaSecondary }}
              </a>
            </div>
            <div class="qr-proof uk-margin-top">
              <span>{{ hero.proof }}</span>
            </div>
            {% if provenExpertRating is defined and provenExpertRating %}
              <div class="provenexpert-rating uk-margin-top" aria-label="Bewertungen">
                {{ provenExpertRating|raw }}
              </div>
            {% endif %}
          </div>
          <div class="calserver-hero-grid__media" data-uk-scrollspy="cls: uk-animation-slide-right-small; repeat: true">
            <div class="calserver-hero-video">
              <span class="pill pill--accent calserver-hero-video__badge">{{ hero.videoBadge }}</span>
              <div class="calserver-hero-video__frame">
                <div class="calserver-hero-video__embed"
                     data-calserver-video
                     data-video-id="ovHo2SF84u0"
                     data-video-title="{{ hero.videoMetaTitle }}"
                     data-video-params="rel=0&playlist=ovHo2SF84u0&loop=1">
                  <div class="calserver-hero-video__placeholder" role="group" aria-label="{{ hero.videoAriaLabel }}">
                    <div class="calserver-hero-video__preview" aria-hidden="true">
                      <span class="calserver-hero-video__preview-title">{{ hero.videoPreviewTitle }}</span>
                      <span class="calserver-hero-video__preview-subtitle">{{ hero.videoPreviewSubtitle }}</span>
                    </div>
                    <p class="calserver-hero-video__hint">{{ hero.videoHint }}</p>
                    <button class="uk-button uk-button-primary calserver-hero-video__consent-button"
                            type="button"
                            data-calserver-video-consent>
                      {{ hero.videoButton }}
                    </button>
                    <p class="calserver-hero-video__privacy-note">{{ hero.videoPrivacy }}</p>
                  </div>
                </div>
                <noscript>
                  <p class="calserver-hero-video__noscript-note">
                    {{ hero.videoNoscript }}
                    <a href="https://www.youtube.com/watch?v=ovHo2SF84u0" target="_blank" rel="noopener">
                      {{ hero.videoNoscriptLink }}
                    </a>{{ hero.videoNoscriptSuffix }}
                  </p>
                </noscript>
              </div>
              <div class="calserver-hero-video__meta">
                <div class="calserver-hero-video__meta-text">
                  <strong>{{ hero.videoMetaTitle }}</strong>
                  <span>{{ hero.videoMetaSubtitle }}</span>
                </div>
                <a class="calserver-hero-video__link"
                   href="https://www.youtube.com/watch?v=ovHo2SF84u0"
                   target="_blank"
                   rel="noopener">
                  <span class="uk-margin-small-right" data-uk-icon="icon: play-circle"></span>{{ hero.videoLinkLabel }}
                </a>
              </div>
              <p class="calserver-hero-video__footnote">
                <strong>{{ hero.videoFootnoteStrong }}</strong>
                <br>
                <span>{{ hero.videoFootnoteSpan }}</span>
              </p>
            </div>
          </div>
        </div>
      </div>
    </section>

    <div id="marketing-chat-modal" class="uk-flex-top marketing-chat-modal" data-uk-modal>
      <div class="uk-modal-dialog uk-modal-body marketing-chat__dialog" role="dialog" aria-modal="true" aria-label="{{ t('marketing_chat_title') }}">
        <button class="uk-modal-close-default" type="button" data-uk-close aria-label="{{ t('marketing_chat_close') }}"></button>
        <h2 class="uk-modal-title">{{ t('marketing_chat_title') }}</h2>
        <p class="marketing-chat__intro">{{ t('marketing_chat_intro') }}</p>
        <div class="marketing-chat__messages" data-marketing-chat-messages aria-live="polite"></div>
        <p class="marketing-chat__status" data-marketing-chat-status aria-live="assertive"></p>
        <form class="marketing-chat__form" data-marketing-chat-form>
          <label class="uk-form-label" for="marketing-chat-question">{{ t('marketing_chat_question_label') }}</label>
          <textarea class="uk-textarea"
                    id="marketing-chat-question"
                    name="question"
                    rows="3"
                    autocomplete="off"
                    placeholder="{{ t('marketing_chat_placeholder') }}"
                    data-marketing-chat-input
                    required></textarea>
          <div class="marketing-chat__form-actions">
            <button type="submit" class="uk-button uk-button-primary">
              <span class="uk-margin-small-right" data-uk-icon="icon: commenting"></span>{{ t('marketing_chat_submit') }}
            </button>
            <button type="button" class="uk-button uk-button-default uk-modal-close">{{ t('marketing_chat_close') }}</button>
          </div>
        </form>
      </div>
    </div>

    {% set pageContent = content %}
    {% set newsSection = '' %}
    {% set newsInserted = false %}

    {% if landingNews is defined and landingNews %}
      {% set newsSection %}
        <section id="calserver-news" class="uk-section uk-section-muted calserver-news">
          <div class="uk-container">
            <div class="uk-flex uk-flex-between uk-flex-middle uk-margin-bottom">
              <h2 class="uk-heading-medium uk-margin-remove">{{ t('calserver_news_heading') }}</h2>
              {% if landingNewsIndexUrl is defined and landingNewsIndexUrl %}
                <a class="uk-button uk-button-text" href="{{ landingNewsIndexUrl }}">{{ t('calserver_news_link') }}</a>
              {% endif %}
            </div>
            <div class="uk-grid-small uk-child-width-1-1 uk-child-width-1-3@m" uk-grid>
              {% for item in landingNews %}
                <div>
                  {% include 'marketing/_news_teaser.twig' with {
                    entry: item,
                    newsBasePath: landingNewsBasePath
                  } %}
                </div>
              {% endfor %}
            </div>
          </div>
        </section>
      {% endset %}

      {% set newsAnchor = '<section class="uk-section uk-section-default" id="pricing">' %}
      {% if newsAnchor in pageContent %}
        {% set pageContent = pageContent|replace({ newsAnchor: newsSection|trim ~ newsAnchor }) %}
        {% set newsInserted = true %}
      {% endif %}
    {% endif %}

    {{ pageContent|raw }}

    {% if newsSection and not newsInserted %}
      {{ newsSection|raw }}
    {% endif %}

    <div class="calserver-cookie-banner uk-card uk-card-default uk-card-body"
         id="calserver-cookie-banner"
         data-calserver-cookie-banner
         role="region"
         aria-live="polite"
         tabindex="-1"
         hidden>
      <div class="calserver-cookie-banner__text">
        <p class="calserver-cookie-banner__headline">
          <span class="calserver-cookie-banner__icon" aria-hidden="true" data-uk-icon="icon: lock"></span>
          Externe Inhalte &amp; Cookies
        </p>
        <p class="calserver-cookie-banner__copy">
          Wir verwenden notwendige Cookies und laden Inhalte von YouTube erst, wenn du zustimmst. Du kannst deine
          Auswahl jederzeit in deinem Browser anpassen.
        </p>
        <p class="calserver-cookie-banner__fineprint">
          Mehr erfährst du in unserer
          <a href="{{ basePath }}/datenschutz" class="calserver-cookie-banner__link">Datenschutzerklärung</a>.
        </p>
      </div>
      <div class="calserver-cookie-banner__actions" role="group" aria-label="Cookie-Auswahl">
        <button class="uk-button uk-button-primary calserver-cookie-banner__button"
                type="button"
                data-calserver-cookie-accept>
          Akzeptieren
        </button>
        <button class="uk-button uk-button-default calserver-cookie-banner__button"
                type="button"
                data-calserver-cookie-necessary>
          Nur notwendige
        </button>
      </div>
    </div>
    <button class="calserver-floating-button calserver-cookie-trigger"
            type="button"
            aria-controls="calserver-cookie-banner"
            aria-expanded="false"
            aria-label="Cookie-Einstellungen öffnen"
            data-calserver-cookie-open
            hidden>
      <span aria-hidden="true" data-uk-icon="icon: fingerprint"></span>
    </button>
    <button class="calserver-floating-button marketing-chat-fab"
            type="button"
            data-marketing-chat-open
            aria-haspopup="dialog"
            aria-controls="marketing-chat-modal"
            aria-label="{{ t('marketing_chat_title') }}">
      <span aria-hidden="true" data-uk-icon="icon: commenting"></span>
    </button>
  </div>
{% endblock %}

{% block footer %}
  <div class="footer-columns">
    <div class="footer-section footer-about">
      <strong>calServer</strong>
      <p>{{ t('calserver_footer_tagline') }}</p>
    </div>
    <div id="contact" class="footer-section footer-contact">
      <strong>Kontakt</strong>
      <p>
        René Buske<br>
        <a
          class="js-email-link"
          data-user="office"
          data-domain="calhelp.de"
          href="#"
        >office [at] calhelp.de</a><br>
        <a href="tel:+4933203609080">+49&nbsp;33203&nbsp;609080</a>
      </p>
    </div>
    <div class="footer-section footer-navigation">
      <strong>Seiten</strong>
      <ul>
        {% for link in links %}
          <li><a href="{{ link.href }}">{{ link.label }}</a></li>
        {% endfor %}
        <li><a href="{{ basePath }}/fluke-metcal">FLUKE MET/CAL</a></li>
      </ul>
    </div>
    <div class="footer-section footer-legal">
      <strong>Rechtliches</strong>
      <ul>
        <li><a href="{{ basePath }}/impressum">{{ t('imprint') }}</a></li>
        <li><a href="{{ basePath }}/datenschutz">{{ t('privacy') }}</a></li>
        <li><a href="{{ basePath }}/lizenz">{{ t('license') }}</a></li>
        {% set accessibilityUrl = locale() == 'en' ? basePath ~ '/calserver/accessibility' : basePath ~ '/calserver/barrierefreiheit' %}
        <li><a href="{{ accessibilityUrl }}">{{ t('accessibility') }}</a></li>
      </ul>
    </div>
  </div>
{% endblock %}

{% block scripts %}
  {% if turnstileSiteKey %}
    <script src="https://challenges.cloudflare.com/turnstile/v0/api.js" defer></script>
  {% endif %}
  <script src="{{ basePath }}/js/custom-icons.js" defer></script>
  <script src="{{ basePath }}/js/storage.js"></script>
  <script>
    (function () {
      try {
        var hasStorageHelpers = typeof STORAGE_KEYS !== 'undefined' &&
          typeof getStored === 'function' &&
          typeof setStored === 'function';
        var darkKey = hasStorageHelpers ? STORAGE_KEYS.DARK_MODE : 'darkMode';
        var storedTheme = hasStorageHelpers ? getStored(darkKey) : (function () {
          try {
            return (typeof localStorage !== 'undefined') ? localStorage.getItem(darkKey) : null;
          } catch (error) {
            return null;
          }
        })();

        if (storedTheme === null) {
          if (hasStorageHelpers) {
            setStored(darkKey, 'false');
          } else if (typeof localStorage !== 'undefined') {
            localStorage.setItem(darkKey, 'false');
          }
        }
      } catch (error) {
        /* empty */
      }
    })();
  </script>
  <script>
    (function () {
      if (!document.body.classList.contains('calserver-theme')) {
        return;
      }

      var hoverIntentTimer;

      function scheduleSwap(event) {
        var link = event.target.closest('a[data-explain]');
        if (!link || !link.closest('.cs-mega-nav')) {
          return;
        }

        clearTimeout(hoverIntentTimer);

        if (event.type === 'focusin') {
          swapPane(link);
          return;
        }

        hoverIntentTimer = setTimeout(function () {
          swapPane(link);
        }, 90);
      }

      function swapPane(link) {
        var dropdown = link.closest('.uk-navbar-dropdown');
        if (!dropdown) {
          return;
        }

        var explainKey = link.getAttribute('data-explain');
        if (!explainKey) {
          return;
        }

        dropdown.querySelectorAll('.menu-explain .explain-pane').forEach(function (pane) {
          var key = pane.getAttribute('data-explain-pane');
          pane.classList.toggle('uk-hidden', key !== explainKey);
        });
      }

      document.addEventListener('mouseover', scheduleSwap, true);
      document.addEventListener('focusin', scheduleSwap, true);
    })();
  </script>
  <script>
    document.addEventListener('DOMContentLoaded', function () {
      document.querySelectorAll('.js-email-link').forEach(function (anchor) {
        var user = anchor.getAttribute('data-user');
        var domain = anchor.getAttribute('data-domain');
        if (user && domain) {
          var email = user + '@' + domain;
          anchor.href = 'mailto:' + email;
          anchor.textContent = email;
        }
      });
      var contactForm = document.getElementById('contact-form');
      if (contactForm && !contactForm.hasAttribute('data-contact-endpoint')) {
        contactForm.setAttribute('data-contact-endpoint', '{{ basePath }}/calserver/contact');
      }
    });
  </script>
  <script>
    window.marketingChatConfig = {
      endpoint: '{{ marketingChatEndpoint|e('js') }}',
      slug: '{{ marketingSlug|e('js') }}',
      csrfToken: '{{ csrf_token|default('')|e('js') }}',
      locale: '{{ locale() }}',
      texts: {
        intro: '{{ t('marketing_chat_intro_message')|e('js') }}',
        loading: '{{ t('marketing_chat_loading')|e('js') }}',
        errorGeneric: '{{ t('marketing_chat_error_generic')|e('js') }}',
        errorValidation: '{{ t('marketing_chat_error_validation')|e('js') }}',
        errorRateLimited: '{{ t('marketing_chat_error_rate_limited')|e('js') }}',
        sources: '{{ t('marketing_chat_sources')|e('js') }}',
        sourcesToggle: '{{ t('marketing_chat_sources_toggle')|e('js') }}',
        score: '{{ t('marketing_chat_score')|e('js') }}',
        empty: '{{ t('marketing_chat_empty')|e('js') }}',
        question: '{{ t('marketing_chat_question_label')|e('js') }}'
      }
    };
  </script>
  <script src="{{ basePath }}/js/calserver-cookie.js" defer></script>
  <script src="{{ basePath }}/js/calserver.js" defer></script>
  <script src="{{ basePath }}/js/marketing-chat.js" defer></script>
  <script src="{{ basePath }}/js/landing.js" defer></script>
{% endblock %}
