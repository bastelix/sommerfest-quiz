{% extends 'layout.twig' %}

{#
  Base layout for CMS-rendered pages. Minimises the head to essential styles
  and skips marketing bundles unless explicitly requested by the page.
#}
{% set designNamespace = designNamespace|default('default') %}

{% block head %}
  {% set includeCmsBaseStyles = includeCmsBaseStyles|default(true) %}
  {% set includeMainStyles = includeMainStyles|default(includeCmsBaseStyles) %}
  {% set includeDarkStyles = includeDarkStyles|default(true) %}
  {% set includeHighContrastStyles = includeHighContrastStyles|default(true) %}
  {% set includeMarketingTopbarStyles = includeMarketingTopbarStyles|default(includeCmsBaseStyles) %}
  {% if includeMainStyles %}
    <link rel="stylesheet" href="{{ basePath }}/css/main.css">
  {% endif %}
  {% if includeMarketingTopbarStyles %}
    <link rel="stylesheet" href="{{ basePath }}/css/topbar.marketing.css">
  {% endif %}
  {% if includeMainStyles and includeDarkStyles %}
    {% set cfg = config is defined ? config : {} %}
    {% set theme = attribute(cfg, 'startTheme')|default('light')|lower %}
    {% set prefersDark = theme == 'dark' %}
    {% set darkMedia = prefersDark ? 'all' : '(prefers-color-scheme: dark)' %}
    <link rel="stylesheet" href="{{ basePath }}/css/dark.css" media="{{ darkMedia }}"{% if not prefersDark %} disabled{% endif %}>
  {% endif %}
  {% if includeMainStyles and includeHighContrastStyles %}
    <link rel="stylesheet" href="{{ basePath }}/css/highcontrast.css">
  {% endif %}
{% endblock %}

{% block footer %}
  {% set footerNavigation = cmsFooterNavigation|default([]) %}
  {% include 'pages/partials/footer.twig' with {
    cmsFooterColumns: cmsFooterColumns|default([]),
    cmsFooterNavigation: footerNavigation,
    cmsLegalNavigation: cmsLegalNavigation|default([])
  } only %}
{% endblock %}
