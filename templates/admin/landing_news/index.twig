{% extends 'layout.twig' %}

{% block title %}{{ t('heading_landing_news') }}{% endblock %}

{% block body_class %}uk-background-muted uk-padding admin-page{% endblock %}

{% block body %}
  {% embed 'topbar.twig' %}
    {% block left %}
      <button
        id="sidebarToggle"
        type="button"
        class="uk-navbar-toggle uk-visible@m uk-margin-small-right git-btn"
        aria-controls="adminSidebar"
        aria-expanded="true"
        aria-pressed="false"
        aria-label="{{ t('menu') }}"
      >
        <span uk-navbar-toggle-icon></span>
      </button>
      <a href="{{ basePath }}/admin/summary" class="uk-navbar-item uk-logo uk-margin-small-left uk-visible@s">
        QuizRace Admin
      </a>
    {% endblock %}
    {% block offcanvas %}
      <div id="qr-offcanvas" uk-offcanvas="overlay: true">
        <div class="uk-offcanvas-bar">
          <button class="uk-offcanvas-close" type="button" uk-close aria-label="{{ t('menu') }}"></button>
          <h3 class="uk-margin-small">QuizRace</h3>
          {% include 'admin/_nav.twig' %}
        </div>
      </div>
    {% endblock %}
    {% block headerbar %}
      <div class="uk-container uk-container-large">
        <div class="uk-flex uk-flex-between uk-flex-middle uk-padding-small uk-padding-remove-horizontal">
          <h1 class="uk-heading-bullet uk-margin-remove">{{ t('heading_landing_news') }}</h1>
          <a class="uk-button uk-button-primary" href="{{ basePath }}/admin/landing-news/create">{{ t('button_add_news') }}</a>
        </div>
      </div>
    {% endblock %}
  {% endembed %}

  <div class="uk-grid-collapse" uk-grid>
    <aside id="adminSidebar" class="uk-width-1-4@m uk-width-1-5@l uk-visible@m qr-sidebar">
      <div class="uk-card qr-card uk-card-body qr-sidebar-card">
        {% include 'admin/_nav.twig' %}
      </div>
    </aside>
    <main class="uk-width-expand uk-padding-small@xs uk-padding">
      <div class="uk-container uk-container-expand">
        {% if status == 'created' %}
          <div class="uk-alert-success" uk-alert>{{ t('message_news_created') }}</div>
        {% elseif status == 'updated' %}
          <div class="uk-alert-success" uk-alert>{{ t('message_news_updated') }}</div>
        {% elseif status == 'deleted' %}
          <div class="uk-alert-success" uk-alert>{{ t('message_news_deleted') }}</div>
        {% endif %}

        <div class="uk-overflow-auto uk-margin-top">
          <table class="uk-table uk-table-divider uk-table-striped">
            <thead>
              <tr>
                <th>{{ t('column_title') }}</th>
                <th>{{ t('column_page') }}</th>
                <th>{{ t('column_status') }}</th>
                <th>{{ t('column_published') }}</th>
                <th>{{ t('column_actions') }}</th>
              </tr>
            </thead>
            <tbody>
              {% for entry in entries %}
                <tr>
                  <td>{{ entry.title }}</td>
                  <td>{{ entry.pageTitle }}</td>
                  <td>
                    {% if entry.isPublished %}
                      <span class="uk-label uk-label-success">{{ t('status_published') }}</span>
                    {% else %}
                      <span class="uk-label">{{ t('status_draft') }}</span>
                    {% endif %}
                  </td>
                  <td>
                    {% if entry.publishedAt %}
                      {{ entry.publishedAt|date('d.m.Y H:i') }}
                    {% else %}
                      &mdash;
                    {% endif %}
                  </td>
                  <td>
                    <div class="uk-flex uk-flex-middle" style="gap: 12px;">
                      <a class="uk-button uk-button-text" href="{{ basePath }}/admin/landing-news/{{ entry.id }}">{{ t('action_edit') }}</a>
                      <form method="post" action="{{ basePath }}/admin/landing-news/{{ entry.id }}/delete" onsubmit="return confirm('{{ t('confirm_news_delete') }}');">
                        <input type="hidden" name="_token" value="{{ csrfToken }}">
                        <button type="submit" class="uk-button uk-button-text uk-text-danger">{{ t('action_delete') }}</button>
                      </form>
                    </div>
                  </td>
                </tr>
              {% else %}
                <tr>
                  <td colspan="5" class="uk-text-center">{{ t('message_news_empty') }}</td>
                </tr>
              {% endfor %}
            </tbody>
          </table>
        </div>
      </div>
    </main>
  </div>
{% endblock %}
