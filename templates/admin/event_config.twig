{% extends 'layout.twig' %}

{% block title %}Event konfigurieren{% endblock %}

{% block head %}
  <meta name="csrf-token" content="{{ csrf_token }}">
  <link rel="stylesheet" href="{{ basePath }}/css/main.css">
  <link rel="stylesheet" href="{{ basePath }}/css/admin-config.css">
{% endblock %}

{% block body_class %}uk-background-muted uk-padding admin-page{% endblock %}

{% block body %}
  <div class="uk-section uk-section-xsmall uk-padding-small uk-section-default" uk-sticky="offset:0">
    <div class="uk-container uk-container-large">
      <div class="uk-flex uk-flex-between uk-flex-middle">
        <div>
          <h1 class="uk-heading-bullet uk-margin-remove">Event konfigurieren</h1>
          <div class="uk-text-meta">ID: {{ event.uid|default('—') }} · letzte Änderung: {{ event.updated_at|default('—') }}</div>
          <div class="uk-text-meta">Änderungen werden automatisch gespeichert.</div>
        </div>
        <div>
          <a class="uk-button uk-button-default" href="{{ basePath }}/?event={{ event.slug|default('demo') }}" target="_blank">Vorschau</a>
        </div>
      </div>
      <div class="uk-margin-top">
        {% include 'admin/components/event_controls.twig' with {
          currentEventUid: event.uid|default(''),
          currentEventName: event.name|default('')
        } %}
      </div>
    </div>
  </div>

  <div class="uk-container uk-container-large uk-margin-top">
    <div class="uk-grid-large" uk-grid>
      <div class="uk-width-expand@m">
        <ul uk-tab>
          <li><a href="#">Basis</a></li>
          <li><a href="#">Login &amp; Zugang</a></li>
          <li><a href="#">Spielregeln</a></li>
          <li><a href="#">Extras</a></li>
          <li><a href="#">Integrationen</a></li>
        </ul>
        <ul class="uk-switcher uk-margin">
          <li>
            <form class="uk-form-stacked">
              <div class="uk-margin">
                <label class="uk-form-label" for="pageTitle">Titel</label>
                <div class="uk-form-controls">
                    <input class="uk-input" id="pageTitle" name="pageTitle" type="text" placeholder="Modernes Quiz mit UIkit" value="{{ config.pageTitle|default('') }}">
                </div>
                <div class="uk-text-meta">Titel des Events für Teilnehmende.</div>
              </div>
              <div class="uk-margin">
                <label class="uk-form-label" for="logo">Logo</label>
                <div class="uk-form-controls">
                  <div uk-form-custom="target: #logo-filename">
                    <input type="file" id="logo" name="logo" accept="image/*">
                    <button class="uk-button uk-button-default" type="button">Datei wählen</button>
                  </div>
                  <input class="uk-input uk-form-width-medium uk-margin-small-top" id="logo-filename" type="text" placeholder="Keine Datei ausgewählt" disabled>
                  <img id="logoPreview" class="uk-margin-top" hidden alt="Logo Vorschau">
                </div>
                <div class="uk-text-meta">Optionales Logo für das Event.</div>
              </div>
              <div class="uk-margin">
                <label class="uk-form-label" for="buttonColor">Primärfarbe</label>
                <div class="uk-form-controls">
                  <input class="uk-input" id="buttonColor" name="buttonColor" type="color" value="{{ config.buttonColor|default('#1e87f0') }}">
                </div>
                <div class="uk-text-meta">Steuert Buttons und Highlights.</div>
              </div>
            </form>
          </li>
          <li>
            <form class="uk-form-stacked">
              <div class="uk-margin">
                <label class="uk-form-label" for="QRUser">Login erforderlich</label>
                <div class="uk-form-controls">
                    <input class="uk-checkbox" id="QRUser" name="QRUser" type="checkbox">
                </div>
                <div class="uk-text-meta">Teilnehmende m&uuml;ssen sich anmelden.</div>
              </div>
              <div class="uk-margin">
                <label class="uk-form-label" for="whitelist">Whitelist</label>
                <div class="uk-form-controls">
                  <textarea class="uk-textarea" id="whitelist" name="whitelist" rows="3" placeholder="user@example.com"></textarea>
                </div>
                <div class="uk-text-meta">Zugelassene E-Mail-Adressen, eine pro Zeile.</div>
              </div>
            </form>
          </li>
          <li>
            <form class="uk-form-stacked">
              <div class="uk-margin">
                <label class="uk-form-label" for="competitionMode">Wettkampfmodus</label>
                <div class="uk-form-controls">
                  <input class="uk-checkbox" id="competitionMode" name="competitionMode" type="checkbox">
                </div>
                <div class="uk-text-meta">Vergibt Punkte und erstellt ein Ranking.</div>
              </div>
              <div class="uk-margin">
                <label><input class="uk-checkbox" id="puzzleWordEnabled" name="puzzleWordEnabled" type="checkbox"> R&auml;tselwort aktivieren</label>
                <div class="uk-text-meta">Erfordert die Eingabe eines R&auml;tselworts zum Abschluss.</div>
              </div>
              <div class="uk-margin">
                <label class="uk-form-label" for="puzzleWord">R&auml;tselwort</label>
                <div class="uk-form-controls">
                  <input class="uk-input" id="puzzleWord" name="puzzleWord" type="text" disabled>
                </div>
                <div class="uk-text-meta">Geheimes Wort, das Teams finden m&uuml;ssen.</div>
              </div>
              <div class="uk-margin">
                <label class="uk-form-label" for="puzzleFeedback">Feedback</label>
                <div class="uk-form-controls">
                  <textarea class="uk-textarea" id="puzzleFeedback" name="puzzleFeedback" rows="3" disabled></textarea>
                </div>
                <div class="uk-text-meta">Nachricht bei richtigem R&auml;tselwort.</div>
              </div>
            </form>
          </li>
          <li>
            <form class="uk-form-stacked">
              <div class="uk-margin">
                <label class="uk-form-label" for="countdown">Countdown</label>
                <div class="uk-form-controls">
                  <input class="uk-input" id="countdown" name="countdown" type="number" min="0" placeholder="0">
                </div>
                <div class="uk-text-meta">Zeitlimit pro Frage in Sekunden. 0 bedeutet kein Limit.</div>
              </div>
            </form>
          </li>
          <li>
            <form class="uk-form-stacked">
              <div class="uk-margin">
                <label class="uk-form-label" for="webhookUrl">Webhook URL</label>
                <div class="uk-form-controls">
                  <input class="uk-input" id="webhookUrl" name="webhookUrl" type="url" placeholder="https://">
                </div>
                <div class="uk-text-meta">Wird bei wichtigen Ereignissen aufgerufen.</div>
              </div>
              <div class="uk-margin">
                <label class="uk-form-label" for="analyticsId">Analytics ID</label>
                <div class="uk-form-controls">
                  <input class="uk-input" id="analyticsId" name="analyticsId" type="text">
                </div>
                <div class="uk-text-meta">z.B. Google Analytics Tracking-ID.</div>
              </div>
            </form>
          </li>
        </ul>
      </div>
      <aside class="uk-width-1-4@m event-config-sidebar">
        <div uk-sticky="offset: 20; bottom: true">
          <div class="uk-card uk-card-default uk-card-body">
            <h3 class="uk-card-title uk-margin-remove">Vorschau</h3>
            <div class="uk-text-center uk-margin-small-top">
              <img id="preview-logo" src="{{ basePath }}/logo-160.svg" alt="Logo" class="uk-margin-small-bottom">
              <div>
                <button class="uk-button uk-button-primary uk-margin-small-right">Primär</button>
                <button class="uk-button uk-button-default">Standard</button>
              </div>
            </div>
          </div>
          <div class="uk-card uk-card-default uk-card-body uk-margin-small-top">
            <h3 class="uk-card-title uk-margin-remove">Status</h3>
            <p class="uk-text-meta uk-margin-small">Entwurf</p>
            <button class="uk-button uk-button-primary uk-width-1-1">Veröffentlichen</button>
          </div>
          <div class="uk-card uk-card-default uk-card-body uk-margin-small-top">
            <h3 class="uk-card-title uk-margin-remove">Presets</h3>
            <div class="uk-margin-small-top">
              <button class="uk-button uk-button-default uk-width-1-1 uk-margin-small-bottom" data-preset="simple">Simple</button>
              <button class="uk-button uk-button-default uk-width-1-1 uk-margin-small-bottom" data-preset="rallye">Rallye</button>
              <button class="uk-button uk-button-default uk-width-1-1" data-preset="competitive">Competitive</button>
            </div>
          </div>
          <div class="uk-card uk-card-default uk-card-body uk-margin-small-top">
            <h3 class="uk-card-title uk-margin-remove">QR-Links</h3>
            <div class="uk-margin-small-top">
              <a class="uk-button uk-button-default uk-width-1-1 uk-margin-small-bottom" href="{{ basePath }}/qr/event?event={{ (event.slug|default('demo')) }}&t={{ ('?event=' ~ (event.slug|default('demo')))|url_encode }}" target="_blank">Event‑QR</a>
              <a class="uk-button uk-button-default uk-width-1-1 uk-margin-small-bottom" href="{{ basePath }}/qr/catalog?t={{ (baseUrl ~ '/?event=' ~ (event.slug|default('demo')) ~ '&katalog=' ~ (catalog.slug|default('default')))|url_encode }}" target="_blank">Katalog‑QR</a>
              <a class="uk-button uk-button-default uk-width-1-1" href="{{ basePath }}/qr/team?t={{ (team|default('team-1'))|url_encode }}" target="_blank">Team‑QR</a>
            </div>
          </div>
        </div>
      </aside>
  </div>
  </div>
{% endblock %}

{% block scripts %}
  <script src="{{ basePath }}/js/event-config.js" data-event-id="{{ event.uid }}" data-csrf="{{ csrf_token }}"></script>
{% endblock %}

