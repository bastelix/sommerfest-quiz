{% extends 'layout.twig' %}

{% block title %}Veranstaltungen{% endblock %}

{% block head %}
  <meta name="csrf-token" content="{{ csrf_token }}">
  <link rel="stylesheet" href="{{ basePath }}/css/main.css">
  <link rel="stylesheet" href="{{ basePath }}/css/dark.css" media="(prefers-color-scheme: dark)">
  <link rel="stylesheet" href="{{ basePath }}/css/highcontrast.css">
{% endblock %}

{% block body_class %}uk-padding{% endblock %}

{% block body %}
  {% embed 'topbar.twig' %}
    {% block center %}
      <span class="uk-navbar-title uk-text-center">Veranstaltungen</span>
    {% endblock %}
  {% endembed %}
  <div class="uk-container uk-container-large">
    <div class="uk-overflow-auto">
      <table id="eventsTable"
             class="uk-table uk-table-divider uk-table-small uk-table-hover"
             data-start-label="{{ t('button_start') }}"
             data-copy-label="Link kopieren"
             data-copy-success="Link kopiert"
             data-copy-error="Kopieren fehlgeschlagen"
             data-copy-warning="Zwischenablage nicht verfÃ¼gbar"
             data-chunk-size="25">
        <thead>
          <tr>
            <th>{{ t('column_name') }}</th>
            <th>{{ t('column_description') }}</th>
            <th class="uk-table-shrink">{{ t('column_actions') }}</th>
          </tr>
        </thead>
        <tbody id="eventsTableBody"></tbody>
        <tbody id="eventsTableFallback">
          {% for ev in events %}
            <tr>
              <td>
                <a href="{{ basePath }}/?event={{ ev.uid }}" class="uk-link-heading">{{ ev.name }}</a>
              </td>
              <td>{{ ev.description }}</td>
              <td class="uk-text-nowrap">
                <button type="button" class="uk-button uk-button-primary event-action event-start" data-uid="{{ ev.uid }}">{{ t('button_start') }}</button>
                <button type="button" class="uk-button uk-button-default event-action copy-link" data-link="{{ basePath }}/?event={{ ev.uid }}">Link kopieren</button>
              </td>
            </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
    <div id="eventsLoadMore" class="uk-flex uk-flex-center uk-margin-top" hidden>
      <div uk-spinner></div>
    </div>
    <div id="catalogsTableWrap" class="uk-overflow-auto uk-margin-top" hidden>
      <h3 class="uk-heading-bullet">{{ t('heading_catalogs') }}</h3>
      <table id="catalogsTable" class="uk-table uk-table-divider uk-table-small uk-table-hover"
             data-start-label="{{ t('button_start') }}"
             data-played-label="{{ t('status_played') }}"
             data-missing-label="{{ t('status_open') }}">
        <thead>
          <tr>
            <th>{{ t('column_name') }}</th>
            <th>{{ t('column_status') }}</th>
            <th class="uk-table-shrink">{{ t('column_actions') }}</th>
          </tr>
        </thead>
        <tbody id="catalogsTableBody"></tbody>
      </table>
    </div>
  </div>
  <script id="events-data" type="application/json">{{ events|json_encode(constant('JSON_HEX_TAG') b-or constant('JSON_HEX_AMP') b-or constant('JSON_HEX_APOS') b-or constant('JSON_HEX_QUOT')) }}</script>
{% endblock %}

{% block scripts %}
  <script src="{{ basePath }}/js/storage.js"></script>
  <script src="{{ basePath }}/js/custom-icons.js"></script>
  <script type="module" src="{{ basePath }}/js/events.js" data-base="{{ basePath }}"></script>
{% endblock %}
