{% extends 'layout.twig' %}

{% block title %}Veranstaltungen{% endblock %}

{% block head %}
  <meta name="csrf-token" content="{{ csrf_token }}">
  <link rel="stylesheet" href="{{ basePath }}/css/dark.css">
  <link rel="stylesheet" href="{{ basePath }}/css/main.css">
  <link rel="stylesheet" href="{{ basePath }}/css/highcontrast.css">
{% endblock %}

{% block body_class %}uk-padding{% endblock %}

{% block body %}
  {% embed 'topbar.twig' %}
    {% block mobile_menu_toggle %}{% endblock %}
    {% block offcanvas %}{% endblock %}
    {% block center %}
      <span class="uk-navbar-title uk-text-center">Veranstaltungen</span>
    {% endblock %}
    {% block right %}
      <div class="theme-switch">
        <button id="theme-toggle" class="uk-icon-button" uk-icon="icon: moon; ratio: 2" aria-label="Design wechseln"></button>
      </div>
      <div class="contrast-switch uk-margin-small-left">
        <button id="contrast-toggle" class="uk-icon-button" uk-icon="icon: paint-bucket; ratio: 2" aria-label="Kontrastmodus"></button>
      </div>
      <a href="{{ basePath }}/faq" class="uk-icon-button uk-margin-small-left" uk-icon="icon: question; ratio: 2" title="Hilfe" aria-label="Hilfe"></a>
    {% endblock %}
  {% endembed %}
  <div class="uk-container uk-container-large">
    <div class="uk-grid-match uk-child-width-1-1 uk-child-width-1-2@s uk-child-width-1-3@m" uk-grid aria-label="Veranstaltungsliste">
      {% for ev in events %}
      <div>
        <div class="uk-card uk-card-default uk-card-hover">
          <div class="uk-card-body">
            <a href="{{ basePath }}/?event={{ ev.uid }}" class="uk-link-toggle">
              <h3 class="uk-card-title">{{ ev.name }}</h3>
              {% if ev.description %}<p>{{ ev.description }}</p>{% endif %}
            </a>
          </div>
          <div class="uk-card-footer">
            {% if role in ['admin','event-manager'] %}
            <button class="uk-button uk-button-primary toggle-publish" data-uid="{{ ev.uid }}" data-published="{{ ev.published ? 'true' : 'false' }}">
              {{ ev.published ? 'Nicht veröffentlichen' : 'Veröffentlichen' }}
            </button>
            {% endif %}
            <button class="uk-button uk-button-default copy-link" data-link="{{ basePath }}/?event={{ ev.uid }}">Link kopieren</button>
          </div>
        </div>
      </div>
      {% endfor %}
    </div>
  </div>
{% endblock %}

{% block scripts %}
  <script src="{{ basePath }}/js/custom-icons.js"></script>
  <script src="{{ basePath }}/js/app.js"></script>
  <script src="{{ basePath }}/js/events.js" data-base="{{ basePath }}"></script>
{% endblock %}
