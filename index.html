<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>Modernes Quiz mit UIkit</title>
  <link rel="stylesheet" href="./css/uikit.min.css">
  <style>
    .sortable-list li {
      cursor: grab;
      background: #f3f7fa;
      border: 1px solid #ddd;
      border-radius: 8px;
      padding: 8px;
      margin-bottom: 8px;
    }

    .sortable-list li:focus {
      outline: 2px solid #39f;
    }
    .dropzone {
      min-height: 2.5em;
      background: #f3f7fa;
      border: 1.5px dashed #aaa;
      border-radius: 8px;
      margin-bottom: 8px;
      display: flex;
      align-items: center;
      padding: 4px 8px;
    }
    .dropzone.over {
      border-color: #39f;
      background: #e0f7fa;
    }
    .dropzone:focus {
      border-color: #39f;
      outline: none;
    }
    .question {
      animation: fadeIn 0.3s ease;
      margin-top: 1em;
    }
    @keyframes fadeIn {
      from { opacity: 0; }
      to { opacity: 1; }
    }
  </style>
</head>
<body class="uk-background-muted uk-padding uk-flex uk-flex-center">
  <div class="uk-container uk-width-1-2@s uk-width-2-3@m">
    <div class="uk-card uk-card-default uk-card-body uk-box-shadow-large uk-margin">
      <h2 class="uk-card-title">Quiz: Digitales Wissen</h2>
      <progress id="progress" class="uk-progress" value="1" max="3"></progress>
      <!-- Sortieren -->
      <div class="question" id="q1">
          <h4>Bringe die Schritte zum Serienbrief in die richtige Reihenfolge:</h4>
          <ul id="sortable" class="uk-list uk-list-divider sortable-list uk-margin" role="list">
            <li draggable="true" role="listitem" tabindex="0" aria-grabbed="false">Datenquelle (Tabelle) erstellen</li>
            <li draggable="true" role="listitem" tabindex="0" aria-grabbed="false">Neues Dokument von Vorlage anlegen</li>
            <li draggable="true" role="listitem" tabindex="0" aria-grabbed="false">Serienbrieffunktion in Word starten</li>
            <li draggable="true" role="listitem" tabindex="0" aria-grabbed="false">Abgangsvermerk am Dokument anbringen</li>
          </ul>
          <button class="uk-button uk-button-primary" onclick="checkSort()">Antwort pr√ºfen</button>
          <div id="sortFeedback" class="uk-margin-top"></div>
          <button class="uk-button uk-button-default uk-margin-top next-btn">Weiter</button>
      </div>
      <!-- Zuordnen -->
      <div class="question uk-hidden" id="q2">
          <h4>Ordne die Begriffe den Definitionen zu:</h4>
          <div class="uk-grid-small uk-child-width-1-2" uk-grid>
            <div>
              <ul id="terms" class="uk-list uk-list-striped" role="list">
                <li draggable="true" role="listitem" tabindex="0" aria-grabbed="false" data-term="Akte">Akte</li>
                <li draggable="true" role="listitem" tabindex="0" aria-grabbed="false" data-term="OE">OE</li>
                <li draggable="true" role="listitem" tabindex="0" aria-grabbed="false" data-term="Snapshot">Snapshot</li>
              </ul>
            </div>
            <div role="list">
              <div class="dropzone" role="listitem" tabindex="0" aria-label="Organisationseinheit mit Rechten an der Akte" data-term="OE">Organisationseinheit mit Rechten an der Akte</div>
              <div class="dropzone" role="listitem" tabindex="0" aria-label="Sammlung von Vorg√§ngen und Dokumenten" data-term="Akte">Sammlung von Vorg√§ngen und Dokumenten</div>
              <div class="dropzone" role="listitem" tabindex="0" aria-label="PDF mit Status zum Zeichnungsprozess" data-term="Snapshot">PDF mit Status zum Zeichnungsprozess</div>
            </div>
          </div>
          <button class="uk-button uk-button-primary uk-margin-small-top" onclick="checkAssign()">Antwort pr√ºfen</button>
          <div id="assignFeedback" class="uk-margin-top"></div>
          <button class="uk-button uk-button-default uk-margin-top next-btn">Weiter</button>
      </div>
      <!-- Multiple Choice -->
      <div class="question uk-hidden" id="q3">
          <h4>Wer hat automatisch Schreibrechte an einer Akte?</h4>
          <form id="mcForm">
            <label><input class="uk-radio" type="radio" name="mc" value="0"> Nur die Fachadministration</label><br>
            <label><input class="uk-radio" type="radio" name="mc" value="1"> Die besitzende OE</label><br>
            <label><input class="uk-radio" type="radio" name="mc" value="2"> Alle Nutzer</label><br>
            <button class="uk-button uk-button-primary uk-margin-top" type="submit">Antwort pr√ºfen</button>
          </form>
          <div id="mcFeedback" class="uk-margin-top"></div>
          <button class="uk-button uk-button-primary uk-margin-top next-btn">Fertig</button>
      </div>
    </div>
  </div>
  <script src="./js/uikit.min.js"></script>
  <script>
    // Sortieren
    let draggedSortItem;
    document.querySelectorAll("#sortable li").forEach(li => {
      li.addEventListener('dragstart', () => {
        draggedSortItem = li;
        li.setAttribute('aria-grabbed', 'true');
      });
      li.addEventListener('dragend', () => li.setAttribute('aria-grabbed', 'false'));
      li.addEventListener('dragover', e => e.preventDefault());
      li.addEventListener('drop', function() {
        if (draggedSortItem !== this) {
          this.parentNode.insertBefore(draggedSortItem, this.nextSibling);
        }
      });
      li.addEventListener('keydown', e => {
        if (e.key === 'ArrowUp' && li.previousElementSibling) {
          li.parentNode.insertBefore(li, li.previousElementSibling);
          li.focus();
        } else if (e.key === 'ArrowDown' && li.nextElementSibling) {
          li.parentNode.insertBefore(li.nextElementSibling, li);
          li.focus();
        }
      });
    });
    window.checkSort = function() {
      const right = [
        "Datenquelle (Tabelle) erstellen",
        "Neues Dokument von Vorlage anlegen",
        "Serienbrieffunktion in Word starten",
        "Abgangsvermerk am Dokument anbringen"
      ];
      const current = Array.from(document.querySelectorAll('#sortable li')).map(li => li.textContent.trim());
      document.getElementById('sortFeedback').innerHTML =
        JSON.stringify(right) === JSON.stringify(current)
        ? '<div class="uk-alert-success" uk-alert>‚úÖ Richtig sortiert!</div>'
        : '<div class="uk-alert-danger" uk-alert>‚ùå Leider falsch, versuche es nochmal!</div>';
    };

    // Zuordnen
    let draggedTerm = null;
    let selectedTerm = null;
    document.querySelectorAll("#terms li").forEach(li => {
      li.addEventListener('dragstart', () => {
        draggedTerm = li;
        li.setAttribute('aria-grabbed', 'true');
      });
      li.addEventListener('dragend', () => li.setAttribute('aria-grabbed', 'false'));
      li.addEventListener('keydown', e => {
        if (e.key === 'Enter' || e.key === ' ') {
          selectedTerm = li;
          li.setAttribute('aria-grabbed', 'true');
          e.preventDefault();
        }
      });
    });
    document.querySelectorAll(".dropzone").forEach(zone => {
      zone.addEventListener('dragover', e => {
        e.preventDefault();
        zone.classList.add('over');
      });
      zone.addEventListener('dragleave', () => zone.classList.remove('over'));
      zone.addEventListener('drop', () => {
        zone.classList.remove('over');
        if (draggedTerm) {
          zone.innerHTML = draggedTerm.textContent;
          zone.dataset.dropped = draggedTerm.getAttribute('data-term');
          draggedTerm.style.visibility = "hidden";
          draggedTerm.setAttribute('aria-grabbed', 'false');
          draggedTerm = null;
        }
      });
      zone.addEventListener('keydown', e => {
        if ((e.key === 'Enter' || e.key === ' ') && selectedTerm) {
          zone.innerHTML = selectedTerm.textContent;
          zone.dataset.dropped = selectedTerm.getAttribute('data-term');
          selectedTerm.style.visibility = "hidden";
          selectedTerm.setAttribute('aria-grabbed', 'false');
          selectedTerm = null;
          e.preventDefault();
        }
      });
    });
    window.checkAssign = function() {
      let allCorrect = true;
      document.querySelectorAll(".dropzone").forEach(zone => {
        if (zone.dataset.term !== zone.dataset.dropped) allCorrect = false;
      });
      document.getElementById('assignFeedback').innerHTML =
        allCorrect
        ? '<div class="uk-alert-success" uk-alert>‚úÖ Alles richtig zugeordnet!</div>'
        : '<div class="uk-alert-danger" uk-alert>‚ùå Nicht alle Zuordnungen sind korrekt.</div>';
    };

    // Multiple Choice
    document.getElementById('mcForm').onsubmit = function(e){
      e.preventDefault();
      const v = document.querySelector('input[name="mc"]:checked');
      document.getElementById('mcFeedback').innerHTML =
        (v && v.value == "1")
        ? '<div class="uk-alert-success" uk-alert>‚úÖ Korrekt! Die besitzende OE hat Schreibrechte.</div>'
        : '<div class="uk-alert-danger" uk-alert>‚ùå Das ist nicht korrekt.</div>';
    };

    // Navigation zwischen den Fragen
    const questions = Array.from(document.querySelectorAll('.question'));
    let current = 0;
    function showQuestion(idx) {
      questions.forEach((q, i) => q.classList.toggle('uk-hidden', i !== idx));
      document.getElementById('progress').value = idx + 1;
    }
    document.querySelectorAll('.next-btn').forEach(btn => {
      btn.addEventListener('click', () => {
        if (current < questions.length - 1) {
          current++;
          showQuestion(current);
        } else {
          btn.disabled = true;
          document.body.insertAdjacentHTML('beforeend', '<div class="uk-alert-success uk-margin-top">üéâ Danke f√ºrs Mitmachen!</div>');
        }
      });
    });
  </script>
</body>
</html>
